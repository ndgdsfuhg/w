(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7482],{16746:(e,t,a)=>{"use strict";a.d(t,{h:()=>d,v:()=>u});var n=a(95155),r=a(12115),i=a(59434),o=a(18720),s=a(37621),l=a(20063);let c=(0,r.createContext)(void 0);function d(e){var t;let{children:a}=e,{ready:d,authenticated:u,user:f,login:p,logout:g}=(0,i.X)(),[m,k]=(0,r.useState)(!1),[h,y]=(0,r.useState)(!1),v=(0,l.useSearchParams)();(0,r.useEffect)(()=>{let e=v.get("ref");e&&localStorage.setItem("ref_code",e)},[v]);let w=(null==f||null==(t=f.wallet)?void 0:t.address)||null,b=u&&d&&!w;(0,r.useEffect)(()=>{(async()=>{if(u&&(null==f?void 0:f.id)&&w&&!h)try{console.log("\uD83D\uDD04 Auto-registering user:",{privyId:f.id,walletAddress:w.slice(0,8)+"..."+w.slice(-8)});let e=localStorage.getItem("ref_code")||void 0,t=await (0,s.DY)(f.id,w,e);t.success?(y(!0),t.created&&(localStorage.removeItem("ref_code"),o.oR.success("Welcome! Your account has been created."))):console.error("❌ User registration failed:",t.error)}catch(e){console.error("❌ Error during user registration:",e)}})()},[u,null==f?void 0:f.id,w,h]),(0,r.useEffect)(()=>{u||y(!1)},[u]);let S=e=>{let t=e||w;return t?"".concat(t.slice(0,4),"...").concat(t.slice(-4)):""},E=async()=>{if(!w)return void o.oR.error("No wallet address available");try{await navigator.clipboard.writeText(w),k(!0),o.oR.success("Wallet address copied to clipboard!",{description:S(w),duration:2e3}),setTimeout(()=>{k(!1)},2e3)}catch(e){console.error("Failed to copy wallet address:",e),o.oR.error("Failed to copy wallet address")}};return(0,n.jsx)(c.Provider,{value:{isLoggedIn:u,user:f,walletAddress:w,walletLoading:b,login:p,logout:g,ready:d,requireAuth:()=>{u||p()},truncateWalletAddress:S,copyWalletAddress:E},children:a})}function u(){let e=(0,r.useContext)(c);if(void 0===e)throw Error("useLogin must be used within a LoginProvider");return e}},17443:(e,t,a)=>{"use strict";a.d(t,{a:()=>o,i:()=>s});var n=a(95155),r=a(12115);let i=(0,r.createContext)(void 0),o=()=>{let e=(0,r.useContext)(i);if(void 0===e)throw Error("useConversion must be used within a ConversionProvider");return e},s=e=>{let{children:t}=e,[a,o]=(0,r.useState)(150),[s,l]=(0,r.useState)(!1),[c,d]=(0,r.useState)(null),[u,f]=(0,r.useState)(null),[p,g]=(0,r.useState)("fallback"),m=async()=>{l(!0),d(null);try{let e=await fetch("/api/price/sol",{cache:"no-store"});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let t=await e.json();if(t.success)o(t.price),f(new Date(t.lastUpdated)),g("api"),d(null);else throw t.fallback&&(o(t.fallback.price),g("fallback")),Error(t.error||"Failed to fetch price")}catch(e){d(e instanceof Error?e.message:"Failed to fetch SOL price"),(!a||a<=0)&&(o(150),g("fallback"),f(new Date))}finally{l(!1)}};return(0,r.useEffect)(()=>{m();let e=setInterval(()=>{m()},3e4);return()=>{clearInterval(e)}},[]),(0,n.jsx)(i.Provider,{value:{solPrice:a,isLoading:s,error:c,lastUpdated:u,source:p,solToUsd:e=>e&&a?e*a:0,usdToSol:e=>e&&a?e/a:0,formatUsd:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return isNaN(e)?"$0.00":"$".concat(e.toFixed(t))},formatSol:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;return isNaN(e)?"0.000000 SOL":"".concat(e.toFixed(t)," SOL")},refreshPrice:m},children:t})}},37621:(e,t,a)=>{"use strict";a.d(t,{DY:()=>l,Fs:()=>r,Lf:()=>o,Zk:()=>s,rn:()=>i});var n=a(59434);async function r(e){let t=await (0,n.N)();return(await fetch("/api/user/me/username-status",{headers:{Authorization:"Bearer ".concat(t)}})).json()}async function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=await (0,n.N)();return(await fetch("/api/balance/check",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify({walletAddress:e,entryFeeUsd:t})})).json()}async function o(e,t){try{let a=await (0,n.N)(),r=await fetch("/api/cashin/store-pending",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify({signature:e,privyId:t})}),i=await r.json();if(!r.ok)return{success:!1,error:i.error||"Failed to store pending transaction",details:i.details,duplicate:i.duplicate,pending:i.pending,in_game:i.in_game};return{success:!0,transaction:i.transaction}}catch(e){return console.error("Error storing pending cashin:",e),{success:!1,error:"Network error while storing pending transaction",details:e instanceof Error?e.message:"Unknown error"}}}async function s(e){try{let t=await (0,n.N)(),a=await fetch("/api/cashin/status",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({privyId:e})});return await a.json()}catch(e){return{success:!1,status:null,error:e instanceof Error?e.message:"Unknown error"}}}async function l(e,t,a){try{let r=await (0,n.N)(),i=await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({privy_id:e,wallet_address:t,...a?{ref_code:a}:{}})}),o=await i.json();if(!i.ok)return{success:!1,created:!1,error:o.error||"Failed to register user"};return{success:!0,user:o.user,created:o.created}}catch(e){return console.error("Error registering user:",e),{success:!1,created:!1,error:e instanceof Error?e.message:"Network error while registering user"}}}},47790:()=>{},98094:(e,t,a)=>{"use strict";a.d(t,{H:()=>s,h:()=>l});var n=a(95155),r=a(12115),i=a(59434);let o=(0,r.createContext)(void 0);function s(e){let{children:t}=e,a=["Coral Red","Sky Blue","Golden Yellow","Pink","Purple","Cyan","Emerald Green","Red Orange","Ocean Blue"],s=[{id:"random",name:"Random",value:"random",type:"color",enabled:!0},...["#FF6B6B","#45B7D1","#FECA57","#FF9FF3","#5F27CD","#00D2D3","#10AC84","#EE5A24","#0984E3"].map((e,t)=>({id:"snake_".concat(t),name:"".concat(a[t]," Snake"),value:e,type:"color",enabled:!0})),{id:"skin-blue",name:"Blue Skin",value:"/images/skins/skin-blue.png",type:"image",imagePath:"/images/skins/skin-blue.png",noRotation:!0,enabled:!1,locked:!0},{id:"skin-cyan",name:"Cyan Skin",value:"/images/skins/skin-cyan.png",type:"image",imagePath:"/images/skins/skin-cyan.png",noRotation:!0,enabled:!1,locked:!0},{id:"skin-green",name:"Green Skin",value:"/images/skins/skin-green.png",type:"image",imagePath:"/images/skins/skin-green.png",noRotation:!0,enabled:!1,locked:!0},{id:"skin-pink",name:"Pink Skin",value:"/images/skins/skin-pink.png",type:"image",imagePath:"/images/skins/skin-pink.png",noRotation:!0,enabled:!1,locked:!0},{id:"skin-purple",name:"Purple Skin",value:"/images/skins/skin-purple.png",type:"image",imagePath:"/images/skins/skin-purple.png",noRotation:!0,enabled:!1,locked:!0},{id:"skin-red",name:"Red Skin",value:"/images/skins/skin-red.png",type:"image",imagePath:"/images/skins/skin-red.png",noRotation:!0,enabled:!1,locked:!0},{id:"skin-yellow",name:"Yellow Skin",value:"/images/skins/skin-yellow.png",type:"image",imagePath:"/images/skins/skin-yellow.png",noRotation:!0,enabled:!1,locked:!0}],[l]=(0,r.useState)(s),[c,d]=(0,r.useState)("random"),[u,f]=(0,r.useState)("random"),[p,g]=(0,r.useState)(null),[m]=(0,r.useState)([{id:"none",name:"None",type:"hat",rarity:"common",preview:"none",enabled:!0,sizeOffset:1,positionOffset:{x:0,y:0}},{id:"random",name:"Random",type:"hat",rarity:"special",preview:"random",enabled:!0,sizeOffset:1,positionOffset:{x:0,y:0}},{id:"beta-hat",name:"Beta Hat",type:"hat",rarity:"epic",preview:"/images/hats/beta-hat.png",imagePath:"/images/hats/beta-hat.png",enabled:!1,locked:!0,sizeOffset:1.7,positionOffset:{x:0,y:-7}}]),[k,h]=(0,r.useState)("none"),y=l.filter(e=>!1!==e.enabled),v=l.filter(e=>!0===e.locked),w=l.filter(e=>!0!==e.locked),b=l.find(e=>e.id===c)||null,S="random"===c,E=m.filter(e=>e.enabled),P=m.filter(e=>!0===e.locked),N=m.filter(e=>!0!==e.locked),C=m.find(e=>e.id===k)||null,F=()=>{let e=y.filter(e=>"random"!==e.id);if(0===e.length)return null;let t=Math.floor(Math.random()*e.length);return e[t]},O=e=>l.find(t=>t.id===e)||null,R=e=>m.find(t=>t.id===e)||null,T=async e=>{let t=O(e);if(t&&!1!==t.enabled&&!0!==t.locked){d(e);try{let a=await (0,i.N)();if(a){let n="random"===e?{id:"random"}:{id:t.id,name:t.name,value:t.value,type:t.type};await fetch("/api/appearance/skin",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify({skin:n})})}}catch(e){console.error("Failed to save skin selection:",e)}if("random"===e){let e=F();f(e?e.value:"#0000FF"),g(e)}else f(t.value),g(null)}};return(0,r.useEffect)(()=>{let e=!0;return(async()=>{try{let t=await (0,i.N)();if(!t)return;let a=await fetch("/api/appearance/skin",{method:"GET",headers:{Authorization:"Bearer ".concat(t)}});if(!a.ok)return;let n=await a.json(),r=(null==n?void 0:n.skin)||null;if(!e)return;if(r&&r.id){let e=r.id,t=O(e);if("random"===e){d("random");let e=F();e&&(f(e.value),g(e))}else if(t)d(e),f(t.value),g(null);else{let e=l.find(e=>"skin-blue"===e.id)||l.find(e=>"color"===e.type);e&&(d(e.id),f(e.value),g(null))}}else{let e=l.find(e=>"skin-blue"===e.id)||l.find(e=>"color"===e.type);e&&(d(e.id),f(e.value),g(null))}}catch(e){}})(),()=>{e=!1}},[]),(0,r.useEffect)(()=>{let e=O(c);if(e)if("random"===c){let e=F();e&&(f(e.value),g(e))}else f(e.value),g(null)},[c]),(0,n.jsx)(o.Provider,{value:{allSkins:l,enabledSkins:y,lockedSkins:v,unlockedSkins:w,selectedSkinId:c,selectedSkin:b,currentDisplayColor:u,allHats:m,enabledHats:E,lockedHats:P,unlockedHats:N,selectedHatId:k,selectedHat:C,selectSkin:T,selectHat:e=>{let t=R(e);t&&t.enabled&&!0!==t.locked&&h(e)},getRandomEnabledSkin:F,getRandomEnabledHat:()=>{let e=E.filter(e=>"random"!==e.id&&"none"!==e.id);if(0===e.length)return null;let t=Math.floor(Math.random()*e.length);return e[t]},getSkinById:O,getHatById:R,isRandomSelected:S,isRandomHatSelected:"random"===k,getResolvedSkinForGame:()=>S?p:b},children:t})}function l(){let e=(0,r.useContext)(o);if(void 0===e)throw Error("useSkin must be used within a SkinProvider");return e}}}]);